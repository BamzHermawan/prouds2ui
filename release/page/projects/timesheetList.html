<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
	<meta name="author" content="PT Sigma Cipta Caraka (Telkomsigma)">
	<meta name="description" content="HOME for PROUDS 2 Web Application">
	<link rel="icon" href="http://localhost:5501/media/favicon.png" type="image/x-icon">
	<title>TIMESHEET | PROUDS 2</title>

	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.7.2/animate.min.css">
	<link rel="stylesheet" href="https://cdn.materialdesignicons.com/3.9.97/css/materialdesignicons.min.css">
	<link rel="stylesheet" href="../../src/style.min.css">
	<link rel="stylesheet" href="../../src/perfect-scrollbar.min.css">
</head>

<body>
	<div class="loader-wrapper animated fadeIn">
		<img src="http://localhost:5501/media/loader.gif">
	</div>

	<div id="main-layout" class="wrapper open-first">
		<section id="side-main" class="sidebar">
			<div class="brand animated slideInLeft fast">
				<span>PROUDS</span>
			</div>
			<div class="side-list animated slideInLeft faster">
				<a href="#notification" class="parent-list">
					<div class="list-title">
						<label>
							<span class="mdi mdi-bell-outline in-left"></span>
							<span>Notification</span>
						</label>
						<div class="action">
							<span class="tag is-warning">{{notifCount}}</span>
						</div>
					</div>
				</a>
			</div>

			<!-- Sidebar disesuaikan dengan halaman yang dibuka -->
			<side-list label="Project" name="project">
				<side-item href="list.html">Project List</side-item>
				<side-item href="projectassignment.html">Project Assignment</side-item>
				<side-item href="projectrequest.html">Project Request</side-item>
				<side-item active>My Tasks</side-item>
				<side-item href="./timesheetApproval.html">Timesheet Approval</side-item>
				<side-item href="../maintenance.html">Rebaseline</side-item>
				<side-item href="../maintenance.html">Closing</side-item>
			</side-list>

			<side-list label="My Workspace" name="ws"></side-list>
		</section>

		<nav id="nav-main" class="navbar main is-primary" role="navigation" aria-label="main navigation">
			<div class="navbar-menu main-navbar">
				<div class="navbar-start">
					<a id="toggle-sidebar" class="navbar-item">
						<span class="mdi mdi-chevron-left mdi-24px"></span>
					</a>

					<a class="navbar-item is-active">
						PROJECT
					</a>

					<a class="navbar-item">
						Resource
					</a>

					<a class="navbar-item">
						Monitoring
					</a>

					<a class="navbar-item">
						Operations
					</a>

					<a class="navbar-item">
						Reports
					</a>
				</div>

				<div class="navbar-end">
					<a href="../maintenance.html" class="navbar-item hover-text">
						<span class="mdi mdi-view-dashboard-outline"></span>
						<span data-toggle="text" class="animated fadeIn is-uppercase in-right faster">dashboard</span>
					</a>

					<a href="../maintenance.html" class="navbar-item hover-text">
						<span class="mdi mdi-settings-outline"></span>
						<span data-toggle="text" class="animated fadeIn is-uppercase in-right faster">setting</span>
					</a>

					<div class="navbar-item has-dropdown is-hoverable">
						<div class="navbar-link is-arrowless">
							<span class="mdi mdi-account-outline"></span>
						</div>
						<div class="navbar-dropdown is-boxed is-right">
							<a href="../maintenance.html" class="navbar-item">Account Profile</a>
							<a href="#help" class="navbar-item">Need Help ?</a>
							<a id="prouds-acting-menu" data-action="http://localhost:5501/demo/post_detect.php" class="navbar-item">Acting As</a>
							<hr class="navbar-divider">
							<a href="#" class="navbar-item">
								<span>Sign Out</span>
								<span class="mdi mdi-logout-variant"></span>
							</a>
						</div>
					</div>
				</div>
			</div>
		</nav>

		<section id="vapp" class="contentPage">
			<section class="hero is-light is-bold">
				<div class="hero-body">
					<div class="container">
						<h1 class="title is-marginless">
							<span>My Tasks</span>
						</h1>
						<div id="bookmarkPage">
							<bookmark-button></bookmark-button>
						</div>
					</div>
				</div>
			</section>
			<section class="section">
				<div id="contentApp" class="container">

					<div v-if="showList">
						<nav class="level">
							<div class="level-left">
								<span class="button is-static">You had task until <span style="margin-right:5px;"></span> <b>{{ endWorkload }}</b></span>
							</div>
							<div class="level-right">
								<b-button tag="a" href="#history-timesheet" type="is-info is-light">
									<span class="icon">
										<span class="mdi mdi-history"></span>
									</span>
									<span>History Timesheet</span>
								</b-button>
							</div>
						</nav>

						<task-group title="Overdue Task" :value="false" type="is-delayed">
							<div class="columns is-multiline">
								<div v-for="(ts, idx) in task.delayed" :key="idx" class="column is-4-desktop is-6">
									<task-card @clicked="setTimesheet(ts)" type="is-delayed" :task="ts"></task-card>
								</div>
							</div>

							<b-message v-if="task.delayed.length <= 0" type="is-success">
								<p class="has-text-centered">Hooray, you have no delayed task ðŸŽ‰</p>
							</b-message>
						</task-group>
	
						<task-group title="On Going Task" always-show="">
							<div class="columns is-multiline">
								<div v-for="(ts, idx) in task.ongoing" :key="idx" class="column is-4-desktop is-6">
									<task-card @clicked="setTimesheet(ts)" :task="ts"></task-card>
								</div>
							</div>

							<b-message v-if="task.ongoing.length <= 0" type="is-info">
								<p class="has-text-centered">Today you have no task, please stand by ðŸš€</p>
							</b-message>
						</task-group>
	
						<task-group title="Scheduled Task" type="is-scheduled">
							<div v-for="(group, i) in task.scheduled" :key="i">
								<div :class="'task-divider' + (i==0?' no-top-margin':'')">
									<p>Task Starting in <b>{{ group.month }}</b></p>
								</div>
								<div class="columns is-multiline">
									<div v-for="(ts, idx) in group.list" :key="idx" class="column is-4-desktop is-6">
										<task-card type="is-scheduled" :task="ts"></task-card>
									</div>
								</div>
							</div>

							<b-message v-if="task.scheduled.length <= 0" type="is-light">
								<p class="has-text-centered">There is currently no scheduled task</p>
							</b-message>
						</task-group>
					</div>

					<div v-if="showForm" class="animated fadeIn faster">
						<div class="columns is-marginless">
							<div class="column is-8-desktop content is-marginless is-paddingless">
								<h3 class="is-small has-text-weight-light is-reduced-margin is-uppercase">
									{{ dataForm.project_name }}</h3>
								<b-field grouped="">
									<div class="control">
										<b-taglist attached="">
											<b-tag type="is-dark">ID</b-tag>
											<b-tag type="is-info">{{ dataForm.project_id }}</b-tag>
										</b-taglist>
									</div>
									<div class="control">
										<b-taglist attached="" size="are-medium">
											<b-tag type="is-dark">IWO</b-tag>
											<b-tag type="is-info">{{ dataForm.iwo }}</b-tag>
										</b-taglist>
									</div>
									<div class="control">
										<b-taglist attached="" size="are-medium">
											<b-tag type="is-dark">Project Manager</b-tag>
											<b-tag type="is-info">{{ dataForm.pm_name }}</b-tag>
										</b-taglist>
									</div>
									<div class="control">
										<b-taglist attached="" size="are-medium">
											<b-tag type="is-dark">Member</b-tag>
											<b-tag type="is-info">{{ dataForm.member }}</b-tag>
										</b-taglist>
									</div>
									<div class="control">
										<b-taglist attached="" size="are-medium">
											<b-tag type="is-dark">Workload</b-tag>
											<b-tag type="is-info">{{ dataForm.workload }}%</b-tag>
										</b-taglist>
									</div>
								</b-field>
								<span class="button is-warning-blend is-static is-small" style="padding: 0px 2.5em; margin-right: 1em;">
									<span style="margin-right:.35em;">Assigned as</span><b>{{ dataForm.role }}</b>
								</span>
								<span class="button is-warning-blend is-static is-small" style="padding: 0px 2.5em;">
									<span class="icon is-small">
										<span class="mdi mdi-calendar-clock"></span>
									</span>
									<span>{{ dataForm.start | moment }} - {{ dataForm.end | moment }}</span>
								</span>
							</div>
							<div class="column is-clearfix is-paddingless">
								<a class="button is-danger is-long is-pulled-right" @click="setTimesheet">
									â—€ Back
								</a>
							</div>
						</div>

						<!-- Add horizontal line -->
						<hr>

						<form @submit="submitForm" action="http://localhost:5501/demo/post_detect.php" method="POST" enctype="multipart/form-data">
							<div class="columns">
								<div class="column is-8-desktop add-border-right">
									<b-message type="is-info" size="is-small" title="Task" :closable="false" class="is-normal-font">
										<b-input type="hidden" name="task_id" :value="dataForm.task_id"></b-input>
										<p class="has-text-weight-light">{{ dataForm.task }}</p>
									</b-message>

									<b-field label="Activity">
										<b-input maxlength="200" type="textarea" name="activity" placeholder="Describe your activity related to this task so that your pm could understand what you do." required=""></b-input>
									</b-field>
								</div>
								<div class="column is-4-desktop">
									<input type="hidden" name="startDate" :value="startDate">
									<input type="hidden" name="endDate" :value="endDate">
									<input type="hidden" name="dateIsRange" :value="rangeToggle">
									<b-field label="Timesheet Date">
										<b-tooltip label="Please Select Timesheet Date" type="is-warning" :active="datepicker.alert" always="" style="width:100%;">
											<b-button type="is-success" outlined="" icon-left="calendar" class="is-fullwidth" @click="openModalDate">
												<span>{{ timesheetDate }}</span>
											</b-button>
										</b-tooltip>
									</b-field>
									<nav class="level">
										<div class="level-left">
											<b-switch size="is-small" type="is-info" v-model="rangeToggle">Pick date as range</b-switch>
										</div>
									</nav>

									<b-tooltip :label="workhour.alert" type="is-warning" :active="workhour.alert != ''" always="" style="width:100%;">
										<b-field label="Total Work Hour" style="margin-bottom: 23px;">
											<b-numberinput controls-position="compact" name="hour" min="0" max="24" expanded="" placeholder="0" :editable="false" v-model="workhour.value" type="is-info">
											</b-numberinput>
										</b-field>
									</b-tooltip>

									<crud-input type="select" name="location" label="Working Location" placeholder="Choose area location">
										<option selected="" style="display: none;"></option>
										<option value="1">Jabodetabek</option>
										<option value="2">Non Lokal Jawa</option>
										<option value="3">Luar Jawa Dalam Negeri</option>
										<option value="4">Luar Negeri</option>
									</crud-input>

									<button class="button is-success is-long" type="submit">
										Submit
									</button>
								</div>
							</div>
						</form>
					</div>

					<b-modal :active.sync="modal.rangeDate" trap-focus="" width="630px" class="has-hidden-scrollbar">
						<b-message type="is-info">
							Pick Timesheet Date
						</b-message>
						<div class="columns">
							<div class="column">
								<div class="card is-inline-datepicker">
									<header class="card-header">
										<p class="card-header-title">
											Timesheet Start Date
										</p>
									</header>
									<b-datepicker inline="" v-model="datepicker.start.val" :max-date="new Date()" :min-date="getMinDate()" :focused-date="datepicker.start.focused" :events="selectedDateList">
										<template slot="header">
											<b-field>
												<b-field>
													<b-select placeholder="Select Month" v-model="datepicker.start.selected" @input="selectMonth('start')" expanded="">
														<option :key="i" v-for="(item, i) in monthList">
															{{ item.label }}
														</option>
													</b-select>
												</b-field>
											</b-field>
										</template>
									</b-datepicker>
								</div>
							</div>
							<div class="column">
								<div class="card is-inline-datepicker">
									<header class="card-header">
										<p class="card-header-title">
											Timesheet End Date
										</p>
									</header>
									<b-datepicker inline="" v-model="datepicker.end.val" :max-date="new Date()" :min-date="datepicker.start.val" :focused-date="datepicker.end.focused" :events="selectedDateList">
										<template slot="header">
											<b-field>
												<b-field>
													<b-select placeholder="Select Month" v-model="datepicker.end.selected" @input="selectMonth('end')" expanded="">
														<option :key="i" v-for="(item, i) in monthList">
															{{ item.label }}
														</option>
													</b-select>
												</b-field>
											</b-field>
										</template>
									</b-datepicker>
								</div>
							</div>
						</div>
					</b-modal>
					
					<b-modal :active.sync="modal.singleDate" trap-focus="" width="302px" class="has-hidden-scrollbar">
						<b-message type="is-info" v-if="rangeToggle">
							Pick Timesheet Date
						</b-message>
						<div class="columns">
							<div class="column">
								<div class="card is-inline-datepicker">
									<header class="card-header">
										<p class="card-header-title">
											Timesheet Date
										</p>
									</header>
									<b-datepicker inline="" v-model="datepicker.start.val" :max-date="new Date()" :min-date="getMinDate()" :focused-date="datepicker.start.focused" :events="datepicker.filled">
										<template slot="header">
											<b-field>
												<b-field>
													<b-select placeholder="Select Month" v-model="datepicker.start.selected" @input="selectMonth('start')" expanded="">
														<option :key="i" v-for="(item, i) in monthList">
															{{ item.label }}
														</option>
													</b-select>
												</b-field>
											</b-field>
										</template>
									</b-datepicker>
								</div>
							</div>
						</div>
					</b-modal>
				</div>
			</section>
		</section>

		<section id="infoFooter">
			<info-footer api-entry-chart="http://localhost:5501/demo/chart.php?entry" api-utilization-chart="http://localhost:5501/demo/chart.php?utilization" entry="100" utilization="100">
			</info-footer>
		</section>
	</div>

	<div class="api-testing" base="http://localhost:5501/demo/">
		<!-- 
				expected return from getNotification!
				[{
					"id": {String},
					"subject": {String},
					"content": {HTML String},
					"dateStamp": {Date String with format DD/MM/YYYY},
					"timeStamp": {Time String with format H:i},
					"read": {Boolean}
				}, ... ],
			 -->
		<api-test url="getNotification.php" key="getNotification"></api-test>
	
		<!-- 
				Get List of Filled Timesheet Date
				@param {*} id: Assignment ID
				@param {*} start: Task Start Date (DD/MM/YYYY)
				@param {*} end: Task End Date (DD/MM/YYYY)

				expected return List of Filled Timesheet Date
				[ 'DD/MM/YYYY', 'DD/MM/YYYY', 'DD/MM/YYYY', ... ]
			-->
		<api-test url="getTimesheetDate.php" key="filledTimesheet"></api-test>
	</div>

	<script>// for testing only. boleh dihapus pas di CI nya
var today = new Date().getDate();
var month = new Date().getMonth() + 1;

var randomNumber = function randomNumber() {
  return Math.floor(Math.random() * Math.floor(100));
}; // for testing only. boleh dihapus pas di CI nya
//! yang ngurutin jadinya frontend ðŸ˜­


var ONGOING = [{
  "iwo": "P-1909SCC-TTES1000",
  "project_id": 1000,
  "task_id": 1000,
  "assignment_id": 1000,
  "role": "Remotion irure dolor",
  "pm_name": "Middleton Jordan",
  "project_name": "Commodo aliqua sunt eu quis excepteur dolore non eu ut dolore.",
  "task": "Ad nostrud non sit laboris Lorem aute fugiat ipsum amet officia excepteur aute aliquip id.",
  "start": "26/08/2019",
  "end": "20/03/2020",
  "member": 2,
  "workload": 45,
  "taskProgress": {
    "actual": 82,
    "plan": 60
  },
  "timesheet": {
    "approved": 35,
    "submited": 69
  }
}, {
  "iwo": "P-1909SCC-TTES1001",
  "project_id": 1001,
  "task_id": 1001,
  "assignment_id": 1001,
  "role": "Aquafire commodo id",
  "pm_name": "Brewer Valentine",
  "project_name": "Eiusmod mollit aliqua reprehenderit fugiat sit occaecat.",
  "task": "Id ut consectetur laboris aliqua laboris ad laborum id ad consequat do.",
  "start": "01/09/2019",
  "end": "17/01/2020",
  "member": 4,
  "workload": 50,
  "taskProgress": {
    "actual": 91,
    "plan": 20
  },
  "timesheet": {
    "approved": 33,
    "submited": 50
  }
}, {
  "iwo": "P-1909SCC-TTES1002",
  "project_id": 1002,
  "task_id": 1002,
  "assignment_id": 1002,
  "role": "Ecstasia proident non",
  "pm_name": "Riley Figueroa",
  "project_name": "Id elit exercitation amet pariatur labore sunt est qui commodo.",
  "task": "Proident irure sit qui et.",
  "start": "03/08/2019",
  "end": "17/12/2019",
  "member": 5,
  "workload": 57,
  "taskProgress": {
    "actual": 84,
    "plan": 37
  },
  "timesheet": {
    "approved": 76,
    "submited": 89
  }
}, {
  "iwo": "P-1909SCC-TTES1003",
  "project_id": 1003,
  "task_id": 1003,
  "assignment_id": 1003,
  "role": "Icology excepteur exercitation",
  "pm_name": "Gwendolyn Giles",
  "project_name": "Ad eu occaecat laboris duis officia qui id ea.",
  "task": "In esse minim veniam adipisicing qui consectetur ut pariatur labore elit.",
  "start": "01/09/2019",
  "end": "24/01/2020",
  "member": 5,
  "workload": 90,
  "taskProgress": {
    "actual": 55,
    "plan": 31
  },
  "timesheet": {
    "approved": 87,
    "submited": 100
  }
}, {
  "iwo": "P-1909SCC-TTES1004",
  "project_id": 1004,
  "task_id": 1004,
  "assignment_id": 1004,
  "role": "Polarium laboris nostrud",
  "pm_name": "Kelli Boone",
  "project_name": "Nulla ullamco commodo laborum laboris.",
  "task": "Ipsum commodo qui adipisicing velit adipisicing ut Lorem in adipisicing magna voluptate qui ad.",
  "start": "13/09/2019",
  "end": "02/01/2020",
  "member": 3,
  "workload": 27,
  "taskProgress": {
    "actual": 82,
    "plan": 74
  },
  "timesheet": {
    "approved": 18,
    "submited": 70
  }
}, {
  "iwo": "P-1909SCC-TTES1005",
  "project_id": 1005,
  "task_id": 1005,
  "assignment_id": 1005,
  "role": "Namebox aliqua sint",
  "pm_name": "Hobbs Henry",
  "project_name": "Ut ipsum incididunt ut pariatur ad do.",
  "task": "Anim ea nostrud sint veniam do et ea.",
  "start": "22/06/2019",
  "end": "09/06/2020",
  "member": 2,
  "workload": 27,
  "taskProgress": {
    "actual": 30,
    "plan": 51
  },
  "timesheet": {
    "approved": 88,
    "submited": 90
  }
}, {
  "iwo": "P-1909SCC-TTES1006",
  "project_id": 1006,
  "task_id": 1006,
  "assignment_id": 1006,
  "role": "Katakana magna culpa",
  "pm_name": "Wade Summers",
  "project_name": "Amet deserunt non aliquip occaecat.",
  "task": "Veniam cupidatat labore labore nisi amet laboris aliqua deserunt consectetur elit irure sunt do non.",
  "start": "05/06/2019",
  "end": "13/12/2019",
  "member": 2,
  "workload": 55,
  "taskProgress": {
    "actual": 58,
    "plan": 21
  },
  "timesheet": {
    "approved": 47,
    "submited": 90
  }
}];
var DELAYED = [{
  "iwo": "P-1909SCC-TTES1011",
  "project_id": 10011,
  "task_id": 4,
  "assignment_id": 1000,
  "role": "Zomboid aliquip proident",
  "pm_name": "Gould Berry",
  "project_name": "veniam enim tempor dolor et ex fugiat excepteur est nostrud voluptate pariatur mollit pariatur reprehenderit",
  "task": "Sint dolor cillum aliquip nostrud elit elit do incididunt amet occaecat dolor ipsum dolore irure.",
  "start": "01/01/2018",
  "end": "12/10/2019",
  "member": 3,
  "workload": randomNumber(),
  "taskProgress": {
    "actual": randomNumber(),
    "plan": randomNumber()
  },
  "timesheet": {
    "approved": randomNumber(),
    "submited": randomNumber()
  }
}, {
  "iwo": "P-1909SCC-TTES1012",
  "project_id": 10012,
  "task_id": 5,
  "assignment_id": 1000,
  "role": "Zomboid aliquip proident",
  "pm_name": "Gould Berry",
  "project_name": "pariatur eiusmod anim elit quis laboris.",
  "task": "Exercitation esse proident consequat ut aliquip reprehenderit mollit officia officia aute irure veniam.",
  "start": "02/10/2019",
  "end": "26/10/2019",
  "member": 5,
  "workload": randomNumber(),
  "taskProgress": {
    "actual": randomNumber(),
    "plan": randomNumber()
  },
  "timesheet": {
    "approved": randomNumber(),
    "submited": randomNumber()
  }
}];
var PLANNED = [{
  "iwo": "P-1909SCC-TTES1000",
  "project_id": 1000,
  "task_id": 1000,
  "assignment_id": 1000,
  "role": "Zilodyne quis reprehenderit",
  "pm_name": "Butler Shelton",
  "project_name": "Officia exercitation ipsum minim ex eiusmod ex excepteur amet et aliquip dolor.",
  "task": "Nisi cillum laborum aliqua consequat duis magna proident esse.",
  "start": "16/12/2019",
  "end": "02/02/2020",
  "member": 3,
  "workload": 81
}, {
  "iwo": "P-1909SCC-TTES1001",
  "project_id": 1001,
  "task_id": 1001,
  "assignment_id": 1001,
  "role": "Proxsoft velit laboris",
  "pm_name": "Dejesus Merrill",
  "project_name": "Veniam aliquip exercitation esse culpa proident sunt pariatur irure laborum anim deserunt et consectetur amet.",
  "task": "Consectetur dolor ex id velit duis.",
  "start": "01/12/2019",
  "end": "18/03/2020",
  "member": 4,
  "workload": 41
}, {
  "iwo": "P-1909SCC-TTES1002",
  "project_id": 1002,
  "task_id": 1002,
  "assignment_id": 1002,
  "role": "Iplax est cillum",
  "pm_name": "Douglas Luna",
  "project_name": "Exercitation amet sunt dolore quis excepteur elit velit consequat aute.",
  "task": "Ut laborum commodo tempor adipisicing Lorem aute sunt.",
  "start": "27/12/2019",
  "end": "12/03/2020",
  "member": 4,
  "workload": 100
}, {
  "iwo": "P-1909SCC-TTES1003",
  "project_id": 1003,
  "task_id": 1003,
  "assignment_id": 1003,
  "role": "Earthmark dolore amet",
  "pm_name": "Merritt Ayers",
  "project_name": "Quis est enim duis sint.",
  "task": "Mollit elit laborum nostrud do culpa esse anim eiusmod consectetur laborum nulla.",
  "start": "01/12/2019",
  "end": "03/02/2020",
  "member": 5,
  "workload": 78
}, {
  "iwo": "P-1909SCC-TTES1004",
  "project_id": 1004,
  "task_id": 1004,
  "assignment_id": 1004,
  "role": "Inquala minim qui",
  "pm_name": "Gamble Warren",
  "project_name": "Eiusmod excepteur qui tempor mollit sit commodo sint in cillum id cupidatat.",
  "task": "Aute minim laboris adipisicing id et quis.",
  "start": "27/12/2019",
  "end": "15/02/2020",
  "member": 3,
  "workload": 29
}, {
  "iwo": "P-1909SCC-TTES1005",
  "project_id": 1005,
  "task_id": 1005,
  "assignment_id": 1005,
  "role": "Vixo veniam amet",
  "pm_name": "Tami Buckley",
  "project_name": "Do consectetur quis eiusmod anim enim.",
  "task": "Et nisi consequat ullamco laborum velit consequat magna irure consequat id consectetur occaecat sit anim.",
  "start": "25/12/2019",
  "end": "29/02/2020",
  "member": 3,
  "workload": 78
}];</script>

	<script src="../../src/main.min.js"></script>
	<script src="../../src/projects/timesheetList.min.js"></script>
</body>

</html>